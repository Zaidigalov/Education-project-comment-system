!function(){"use strict";var t={842:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(527));class a{constructor(){this.name=document.querySelector(".main__name").textContent,this.rank=0,this.rankStatus="none",this.month=(new Date).getMonth()+1,this.month<10&&(this.month="0"+this.month),this.day=(new Date).getDate(),this.day<10&&(this.day="0"+this.day),this.hours=(new Date).getHours(),this.hours<10&&(this.hours="0"+this.hours),this.minutes=(new Date).getMinutes(),this.minutes<10&&(this.minutes="0"+this.minutes),this.date=`${this.day}.${this.month} ${this.hours}:${this.minutes}`,this.commentText=document.querySelector(".textarea__input").textContent}makeFavorite(t){if("actions__button__favorite"!==t.classList[0])return;let e=t.parentNode.parentNode.parentNode,n=e.getAttribute("favorite");t.classList.toggle("actions__button__favorite_pressed"),"false"==n?(e.setAttribute("favorite","true"),t.textContent="В избранном"):"true"==n&&(e.setAttribute("favorite","false"),t.textContent="В избранное")}changeRank(t){var e,n,i,s,a,o,r,l,u;if("rating__button"!==t.classList[0])return;let d=null===(n=null===(e=t.nextSibling)||void 0===e?void 0:e.nextSibling)||void 0===n?void 0:n.textContent;null==d&&(d=null===(s=null===(i=t.previousSibling)||void 0===i?void 0:i.previousSibling)||void 0===s?void 0:s.textContent),d=Number(d);let c=t.parentNode.parentNode.parentNode.parentNode,m=+c.getAttribute("freePoints");this.rankStatus=c.getAttribute("rankStatus"),console.log(m),"rating__button_decrease"==t.classList[1]&&("none"==this.rankStatus&&(c.setAttribute("freePoints","1"),m=+c.getAttribute("freePoints"),d-=m,c.setAttribute("rankStatus","decreased"),this.rankStatus=c.getAttribute("rankStatus")),"increased"==this.rankStatus&&(c.setAttribute("freePoints","1"),m=+c.getAttribute("freePoints"),d-=m,c.setAttribute("rankStatus","none"),this.rankStatus=c.getAttribute("rankStatus")),"decreased"==this.rankStatus&&(c.setAttribute("freePoints","0"),m=+c.getAttribute("freePoints")),null===(o=null===(a=t.nextSibling)||void 0===a?void 0:a.nextSibling)||void 0===o||(o.textContent=d)),"rating__button_increase"==t.classList[1]&&("none"==this.rankStatus&&(c.setAttribute("freePoints","1"),m=+c.getAttribute("freePoints"),d+=m,c.setAttribute("rankStatus","increased"),this.rankStatus=c.getAttribute("rankStatus")),"decreased"==this.rankStatus&&(c.setAttribute("freePoints","1"),m=+c.getAttribute("freePoints"),d+=m,c.setAttribute("rankStatus","none"),this.rankStatus=c.getAttribute("rankStatus")),"increased"==this.rankStatus&&(c.setAttribute("freePoints","0"),m=+c.getAttribute("freePoints")),null===(l=null===(r=t.previousSibling)||void 0===r?void 0:r.previousSibling)||void 0===l||(l.textContent=d)),null===(u=t.parentNode)||void 0===u||u.parentNode.parentNode.parentNode.setAttribute("rank",`${d}`),console.log(m),console.log(this.rankStatus)}}let o=new a;document.addEventListener("click",(t=>{o.makeFavorite(t.target)})),document.addEventListener("click",(t=>{o.changeRank(t.target)})),document.addEventListener("click",(t=>{var e;if(null==t.target||!t.target.classList.contains("actions__button__reply"))return;const n=t.target.parentNode.parentNode.parentNode.parentNode;if(document.querySelector(".reply__typing"))return void(null===(e=document.querySelector(".reply__typing"))||void 0===e||e.remove());if(n.childNodes[3]&&("reply"==n.childNodes[3].classList[1]||"reply"==n.childNodes[2].classList[1]))return;let i=new s.default;n.append(i.replyBlock),i.replyBlock.scrollIntoView();let a=document.querySelector(".reply__typing"),o=document.querySelector(".reply-textarea"),r=document.querySelector(".reply-placeholder"),l=o.textContent,u=document.querySelector(".reply-button");function d(){(0==l.length||l.length>i.maxLength)&&i.makeButtonDisabled(u)}o.onfocus=()=>{r.style.display="none"},o.onblur=()=>{0==l.length&&(i.makeButtonDisabled(u),r.style.display="inline",document.querySelector(".reply-symbols_empty").classList.remove("invisible"),document.querySelector(".reply-symbols_typing").classList.add("invisible")),l.length>i.maxLength&&i.makeButtonDisabled(u)},o.addEventListener("input",(t=>{document.querySelector(".reply-symbols_empty").classList.add("invisible"),document.querySelector(".reply-symbols_typing").classList.remove("invisible"),l.length+1>i.maxLength&&"insertText"==t.inputType&&(o.textContent=l.substring(0,i.maxLength),o.focus(),i.placeCaretAtEnd(document.querySelector(".reply-textarea"))),l=o.textContent,document.querySelector(".reply-symbols__quantity").innerHTML=l.length,l.length>0&&l.length<i.maxLength&&i.makeButtonEnabled(u)})),o.addEventListener("paste",(t=>{const e=t.clipboardData||window.clipboardData;e&&e.types&&e.types.includes("Files")&&t.preventDefault()})),o.addEventListener("paste",(t=>{t.preventDefault();let e=t.clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,e)})),o.addEventListener("keydown",(()=>{setTimeout(d,1)})),u.addEventListener("click",(()=>{i.createReply(u),a.remove()}))})),e.default=a},497:function(t,e,n){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=s(n(526));let o=new class{constructor(){this.updateElements=()=>{this.allComments=Array.from(document.querySelectorAll(".comment")),this.quantityOfComments=this.allComments.length,document.querySelector(".info__quantity").innerText=this.quantityOfComments},this.showFavorite=()=>{this.buttonShowFavorite.classList.toggle("show-favorites");let t=Array.from(document.querySelectorAll(".reply__answer"));this.buttonShowFavorite.classList.contains("show-favorites")?t.forEach((t=>{t.style.marginLeft="0"})):t.forEach((t=>{t.style.marginLeft="91px"})),this.allComments.forEach((t=>{"false"==t.getAttribute("favorite")&&(this.buttonShowFavorite.classList.contains("show-favorites")?t.style.display="none":t.style.display="flex")}))},this.commentArea=document.querySelector(".comments"),this.inputModule=new a.default,this.allComments=Array.from(document.querySelectorAll(".comment")),this.quantityOfComments=this.allComments.length,document.querySelector(".info__quantity").innerText=this.quantityOfComments,this.buttonShowFavorite=document.querySelector(".comments__header__favourites"),this.buttonSort=document.querySelector(".sort__button")}changeRank(t){var e,n,i,s,a,o,r,l,u,d,c,m,_;if("rating__button"!==t.classList[0])return;let b=null===(n=null===(e=t.nextSibling)||void 0===e?void 0:e.nextSibling)||void 0===n?void 0:n.textContent;null==b&&(b=null===(s=null===(i=t.previousSibling)||void 0===i?void 0:i.previousSibling)||void 0===s?void 0:s.textContent),b=Number(b);let p=t.parentNode.parentNode.parentNode.parentNode,v=+p.getAttribute("freePoints");this.rankStatus=p.getAttribute("rankStatus"),"rating__button_decrease"==t.classList[1]&&("none"==this.rankStatus&&(p.setAttribute("freePoints","1"),v=+p.getAttribute("freePoints"),b-=v,p.setAttribute("rankStatus","decreased"),this.rankStatus=p.getAttribute("rankStatus")),"increased"==this.rankStatus&&(p.setAttribute("freePoints","1"),v=+p.getAttribute("freePoints"),b-=v,p.setAttribute("rankStatus","none"),this.rankStatus=p.getAttribute("rankStatus")),"decreased"==this.rankStatus&&(p.setAttribute("freePoints","0"),v=+p.getAttribute("freePoints")),null===(o=null===(a=t.nextSibling)||void 0===a?void 0:a.nextSibling)||void 0===o||(o.textContent=b)),"rating__button_increase"==t.classList[1]&&("none"==this.rankStatus&&(p.setAttribute("freePoints","1"),v=+p.getAttribute("freePoints"),b+=v,p.setAttribute("rankStatus","increased"),this.rankStatus=p.getAttribute("rankStatus")),"decreased"==this.rankStatus&&(p.setAttribute("freePoints","1"),v=+p.getAttribute("freePoints"),b+=v,p.setAttribute("rankStatus","none"),this.rankStatus=p.getAttribute("rankStatus")),"increased"==this.rankStatus&&(p.setAttribute("freePoints","0"),v=+p.getAttribute("freePoints")),null===(l=null===(r=t.previousSibling)||void 0===r?void 0:r.previousSibling)||void 0===l||(l.textContent=b)),p.setAttribute("rank",`${b}`),b<0&&(null===(u=t.nextSibling)||void 0===u||(u.nextSibling.style.color="#fa0000ff")),0==b&&((null===(d=t.previousSibling)||void 0===d?void 0:d.previousSibling)?null===(c=t.previousSibling)||void 0===c||(c.previousSibling.style.color="#999999ff"):null===(m=t.nextSibling)||void 0===m||(m.nextSibling.style.color="#999999ff")),b>0&&(null===(_=t.previousSibling)||void 0===_||(_.previousSibling.style.color="#8ac44bff"))}sortComments(){}byDate(t,e){return(t=this.allComments[i].getAttribute("day"))>e?1:t==e?0:t<e?-1:void 0}};document.execCommand("insertBrOnReturn"),new MutationObserver((t=>{t[0].addedNodes[0]&&("tred"!=t[0].addedNodes[0].className&&"reply__answer comment"!=t[0].addedNodes[0].className||o.updateElements())})).observe(o.commentArea,{childList:!0,subtree:!0}),document.addEventListener("click",(t=>{o.changeRank(t.target)})),o.buttonShowFavorite.addEventListener("click",o.showFavorite),o.buttonSort.addEventListener("click",(()=>{let t=document.querySelector(".sort__list"),e=Array.from(document.querySelectorAll(".sort-list__item"));t.classList.toggle("invisible"),e.forEach((e=>{e.addEventListener("click",(()=>{o.buttonSort.textContent=e.textContent,t.classList.add("invisible")}))}))})),o.sortComments()},526:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(842));class a{constructor(){this.cleanTextArea=()=>{this.input.innerText="",this.content="",this.placeholder.style.display="inline",document.querySelector(".main__symbols_empty").classList.remove("invisible"),document.querySelector(".main__symbols_typing").classList.add("invisible"),this.makeButtonDisabled()},this.name="Аноним",document.querySelector(".main__name").textContent=this.name,this.maxLength=10,this.input=document.querySelector(".textarea__input"),this.content=this.input.textContent,this.placeholder=document.querySelector(".textarea__placeholder"),this.buttonSend=document.querySelector(".typing__button"),this.input}placeCaretAtEnd(t){if(t.focus(),void 0!==window.getSelection&&void 0!==document.createRange){let e=document.createRange();e.selectNodeContents(t),e.collapse(!1);let n=window.getSelection();n.removeAllRanges(),n.addRange(e)}else if(void 0!==document.body.createRange){let e=document.body.createRange();e.moveToElementText(t),e.collapse(!1),e.select()}}makeButtonEnabled(){this.buttonSend.classList.remove("button_disabled"),this.buttonSend.classList.add("button_enabled"),this.buttonSend.disabled=!1}makeButtonDisabled(){this.buttonSend.classList.add("button_disabled"),this.buttonSend.classList.remove("button_enabled"),this.buttonSend.disabled=!0}createComment(){var t;let e=new s.default;if(0==(null===(t=this.content)||void 0===t?void 0:t.length))return;let n=document.createElement("article");n.className="tred",n.innerHTML=`\n    <div class="tred__comment comment" replied = "false" favorite = "false" rank = "${e.rank}" freePoints ="1" rankStatus="none">\n              <div class="comment__avatar avatar">\n                <img class="avatar__image" src="https://loremflickr.com/61/61" alt="avatar" />\n              </div>\n              <div class="comment__main">\n                <div class="comment-main__info">\n                  <p class="comment-main__info__name">${e.name}</p>\n                  <p class="comment-main__info__time">${e.date}</p>\n                </div>\n                <div class="main__text">${e.commentText}\n                </div>\n                <div class="main__actions actions">\n                  <span class="actions__button__reply">Ответить</span>\n                  <span class="actions__button__favorite">В избранное</span>\n                  <div class="actions__rating rating">\n                    <button class="rating__button rating__button_decrease">-</button>\n                    <span class="rating__number">${e.rank}</span>\n                    <button class="rating__button rating__button_increase"></button>\n                  </div>\n                </div>\n              </div>\n    </div>`,document.querySelector(".comments").append(n),n.scrollIntoView(),r.push(e),console.log(r)}}let o=new a,r=[];function l(){0==o.content.length&&o.makeButtonDisabled(),o.content.length>o.maxLength&&o.makeButtonDisabled()}o.input.onfocus=()=>{o.placeholder.style.display="none"},o.input.onblur=()=>{0==o.content.length&&(o.makeButtonDisabled(),o.placeholder.style.display="inline",document.querySelector(".main__symbols_empty").classList.remove("invisible"),document.querySelector(".main__symbols_typing").classList.add("invisible")),o.content.length>o.maxLength&&o.makeButtonDisabled()},o.input.addEventListener("input",(t=>{document.querySelector(".main__symbols_empty").classList.add("invisible"),document.querySelector(".main__symbols_typing").classList.remove("invisible"),o.content.length+1>o.maxLength&&"insertText"==t.inputType&&(o.input.textContent=o.content.substring(0,o.maxLength),o.input.focus(),o.placeCaretAtEnd(document.querySelector(".textarea__input"))),o.content=o.input.textContent,document.querySelector(".symbols__quantity").innerHTML=o.content.length,o.content.length>0&&o.content.length<o.maxLength&&o.makeButtonEnabled()})),o.input.addEventListener("paste",(t=>{const e=t.clipboardData||window.clipboardData;e&&e.types&&e.types.includes("Files")&&t.preventDefault()})),o.input.addEventListener("paste",(t=>{t.preventDefault();let e=t.clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,e)})),o.input.addEventListener("keydown",(()=>{setTimeout(l,1)})),o.buttonSend.addEventListener("click",o.createComment),o.buttonSend.addEventListener("click",o.cleanTextArea),e.default=a},620:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this.name=document.querySelector(".main__name").textContent,this.rank=0,this.month=(new Date).getMonth()+1,this.month<10&&(this.month="0"+this.month),this.day=(new Date).getDate(),this.day<10&&(this.day="0"+this.day),this.hours=(new Date).getHours(),this.hours<10&&(this.hours="0"+this.hours),this.minutes=(new Date).getMinutes(),this.minutes<10&&(this.minutes="0"+this.minutes),this.date=`${this.day}.${this.month} ${this.hours}:${this.minutes}`,this.replyText=document.querySelector(".reply-textarea").textContent}}},527:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(620));class a{constructor(){this.cleanTextArea=()=>{this.inputReply.innerText="",this.contentReply="",this.placeholderReply.style.display="inline",document.querySelector(".main__symbols_empty").classList.remove("invisible"),document.querySelector(".main__symbols_typing").classList.add("invisible"),this.makeButtonDisabled()},this.name="Аноним",document.querySelector(".main__name").textContent=this.name,this.maxLength=10,this.replyBlock=document.createElement("div"),this.replyBlock.className="tred__reply",this.replyBlock.innerHTML=`\n    <div class="reply__typing">\n                <div class="reply-typing__avatar avatar">\n                  <img class="avatar__image" src="https://loremflickr.com/61/61" alt="avatar" />\n                </div>\n                <div class="reply-typing__main">\n                  <div class="main__name-and-symbols">\n                    <p class="main__name">${this.name}</p>\n                    <p class="main__symbols main__symbols_empty reply-symbols_empty">Макс. 1000 символов</p>\n                    <p class="main__symbols main__symbols_typing reply-symbols_typing invisible">\n                      <span class="symbols__quantity reply-symbols__quantity">1</span>/1000\n                    </p>\n                  </div>\n                  <div class="main__textarea">\n                    <span class="textarea__placeholder reply-placeholder">Введите текст сообщения...</span>\n                    <div class="textarea__input reply-textarea" contenteditable="true" ondrop="return false;"></div>\n                  </div>\n                </div>\n                <button class="typing__button reply-button button_disabled" disabled>Ответить</button>\n              </div>`}placeCaretAtEnd(t){if(t.focus(),void 0!==window.getSelection&&void 0!==document.createRange){let e=document.createRange();e.selectNodeContents(t),e.collapse(!1);let n=window.getSelection();n.removeAllRanges(),n.addRange(e)}else if(void 0!==document.body.createRange){let e=document.body.createRange();e.moveToElementText(t),e.collapse(!1),e.select()}}makeButtonEnabled(t){t.classList.remove("button_disabled"),t.classList.add("button_enabled"),t.disabled=!1}makeButtonDisabled(t){t.classList.add("button_disabled"),t.classList.remove("button_enabled"),t.disabled=!0}createReply(t){var e,n,i,a,o,r,l,u,d;let c=new s.default;if(0==(null===(e=c.replyText)||void 0===e?void 0:e.length))return;let m=document.createElement("div");m.className="reply__answer comment",m.setAttribute("favorite","false"),m.setAttribute("rank",`${c.rank}`),m.setAttribute("freePoints","1"),m.setAttribute("rankStatus","none"),this.replyBlock.append(m);let _=null===(u=null===(l=null===(r=null===(o=null===(a=null===(i=null===(n=m.parentNode)||void 0===n?void 0:n.previousSibling.previousSibling)||void 0===i?void 0:i.lastChild)||void 0===a?void 0:a.previousSibling)||void 0===o?void 0:o.firstChild)||void 0===r?void 0:r.nextSibling.firstChild)||void 0===l?void 0:l.nextSibling)||void 0===u?void 0:u.textContent;null==_&&(_=null===(d=m.parentNode.previousSibling.lastChild.previousSibling.firstChild)||void 0===d?void 0:d.nextSibling.firstChild.nextSibling.textContent),m.innerHTML=`\n    <div class="comment__avatar avatar">\n                  <img class="avatar__image" src="https://loremflickr.com/61/61" alt="avatar" />\n                </div>\n                <div class="comment__main">\n                  <div class="comment-main__info">\n                    <p class="comment-main__info__name">${c.name}</p>\n                    <p class="comment-main__info__parent-name">${_}</p>\n                    <p class="comment-main__info__time">${c.date}</p>\n                  </div>\n                  <div class="main__text">\n                  ${c.replyText}\n                  </div>\n                  <div class="main__actions actions">\n                    <span class="actions__button__favorite reply__actions__button__favorite">В избранное</span>\n                    <div class="actions__rating rating">\n                      <button class="rating__button rating__button_decrease">-</button>\n                      <span class="rating__number">${c.rank}</span>\n                      <button class="rating__button rating__button_increase"></button>\n                    </div>\n                  </div>\n                </div>`,m.scrollIntoView()}}new a,e.default=a}},e={};!function n(i){var s=e[i];if(void 0!==s)return s.exports;var a=e[i]={exports:{}};return t[i].call(a.exports,a,a.exports,n),a.exports}(497)}();