!function(){"use strict";var t={842:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t){this.name="Аноним",this.rank=0,this.absRank=Math.abs(this.rank),this.rankStatus="none",this.freePoints=1,this.isReplied=!1,this.isFavorite=!1,this.id=t,this.fullDate=(new Date).getTime(),this.month=(new Date).getMonth()+1,this.month<10&&(this.month="0"+this.month),this.day=(new Date).getDate(),this.day<10&&(this.day="0"+this.day),this.hours=(new Date).getHours(),this.hours<10&&(this.hours="0"+this.hours),this.minutes=(new Date).getMinutes(),this.minutes<10&&(this.minutes="0"+this.minutes),this.date=`${this.day}.${this.month} ${this.hours}:${this.minutes}`,this.commentText=document.querySelector(".textarea__input").textContent}}},497:function(t,e,n){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=s(n(526)),a=s(n(842)),o=s(n(527)),l=s(n(620));let r=new class{constructor(){this.updateElements=()=>{this.allComments=Array.from(document.querySelectorAll(".comment")),this.quantityOfComments=this.allComments.length,document.querySelector(".info__quantity").innerText=this.quantityOfComments},this.showFavorite=()=>{this.buttonShowFavorite.classList.toggle("show-favorites");let t=Array.from(document.querySelectorAll(".reply__answer"));this.buttonShowFavorite.classList.contains("show-favorites")?t.forEach((t=>{t.style.marginLeft="0"})):t.forEach((t=>{t.style.marginLeft="91px"})),this.allComments=Array.from(document.querySelectorAll(".comment")),this.allComments.forEach((t=>{"false"==t.getAttribute("favorite")&&(this.buttonShowFavorite.classList.contains("show-favorites")?t.style.display="none":t.style.display="flex")}))},this.changeRank=t=>{var e,n,s,i,a,o,l,r,c;let m=t.parentNode.parentNode.parentNode.parentNode,d=Number(m.id.split("-")[0]),u=this.allCommentsObj.get(d);"rating__button_decrease"==t.classList[1]&&("none"==u.rankStatus&&(u.rank-=u.freePoints,u.rankStatus="decreased"),"increased"==u.rankStatus&&(u.rank-=u.freePoints,u.rankStatus="none"),null===(n=null===(e=t.nextSibling)||void 0===e?void 0:e.nextSibling)||void 0===n||(n.textContent=u.rank)),"rating__button_increase"==t.classList[1]&&("none"==u.rankStatus&&(u.rank+=u.freePoints,u.rankStatus="increased"),"decreased"==u.rankStatus&&(u.rank+=u.freePoints,u.rankStatus="none"),null===(i=null===(s=t.previousSibling)||void 0===s?void 0:s.previousSibling)||void 0===i||(i.textContent=u.rank)),u.rank<0&&(null===(a=t.nextSibling)||void 0===a||(a.nextSibling.style.color="#fa0000ff")),0==u.rank&&((null===(o=t.previousSibling)||void 0===o?void 0:o.previousSibling)?null===(l=t.previousSibling)||void 0===l||(l.previousSibling.style.color="#999999ff"):null===(r=t.nextSibling)||void 0===r||(r.nextSibling.style.color="#999999ff")),u.rank>0&&(null===(c=t.previousSibling)||void 0===c||(c.previousSibling.style.color="#8ac44bff")),this.saveChange(d,u)},this.createComment=()=>{let t=this.allCommentsObj.size,e=new a.default(t);this.allCommentsObj.set(t,e),this.saveComments(t,e)},this.showComments=t=>{if(null==t.commentText)return;let e=document.createElement("article");e.className="tred";let n,s="В избранное",i="";1==t.isFavorite&&(s="В избранном",i="actions__button__favorite_pressed"),t.rank<0&&(n="#fa0000ff"),0==t.rank&&(n="#999999ff"),t.rank>0&&(n="#8ac44bff"),e.innerHTML=`\n    <div class="tred__comment comment" id ="${t.id}" replied = "${t.isReplied}" favorite = "${t.isFavorite}" rank = "${t.rank}" freePoints ="${t.freePoints}" rankStatus="${t.rankStatus}">\n              <div class="comment__avatar avatar">\n                <img class="avatar__image" src="https://loremflickr.com/61/61" alt="avatar" />\n              </div>\n              <div class="comment__main">\n                <div class="comment-main__info">\n                  <p class="comment-main__info__name">${t.name}</p>\n                  <p class="comment-main__info__time">${t.date}</p>\n                </div>\n                <div class="main__text">${t.commentText}\n                </div>\n                <div class="main__actions actions">\n                  <span class="actions__button__reply" id ="${t.id}-btn" >Ответить</span>\n                  <span class="actions__button__favorite ${i}">${s}</span>\n                  <div class="actions__rating rating">\n                    <button class="rating__button rating__button_decrease">-</button>\n                    <span class="rating__number" style=color:${n}>${t.rank}</span>\n                    <button class="rating__button rating__button_increase"></button>\n                  </div>\n                </div>\n              </div>\n    </div>\n    <div class="tred__reply"></div>`,document.querySelector(".comments").append(e),t.appropriateHTMLObject=document.getElementById(`${t.id}`),t.replyObj&&!this.buttonShowFavorite.classList.contains("show-favorites")&&this.showReply(t,t.replyObj),e.scrollIntoView()},this.showReply=(t,e)=>{let n=document.createElement("div");n.className="reply__answer comment",t.appropriateHTMLObject.nextSibling.nextSibling.append(n),n.setAttribute("id",`${e.id}`),n.setAttribute("favorite",`${e.isFavorite}`);let s,i="В избранное",a="";1==e.isFavorite&&(i="В избранном",a="actions__button__favorite_pressed"),e.rank<0&&(s="#fa0000ff"),0==e.rank&&(s="#999999ff"),e.rank>0&&(s="#8ac44bff"),n.innerHTML=`\n    <div class="comment__avatar avatar">\n                  <img class="avatar__image" src="https://loremflickr.com/61/61" alt="avatar" />\n                </div>\n                <div class="comment__main">\n                  <div class="comment-main__info">\n                    <p class="comment-main__info__name">${this.inputModule.name}</p>\n                    <p class="comment-main__info__parent-name">${t.name}</p>\n                    <p class="comment-main__info__time">${e.date}</p>\n                  </div>\n                  <div class="main__text">\n                  ${e.replyText}\n                  </div>\n                  <div class="main__actions actions">\n                    <span class="actions__button__favorite reply__actions__button__favorite ${a}">${i}</span>\n                    <div class="actions__rating rating">\n                      <button class="rating__button rating__button_decrease">-</button>\n                      <span class="rating__number" style=color:${s}>${e.rank}</span>\n                      <button class="rating__button rating__button_increase"></button>\n                    </div>\n                  </div>\n                </div>`,n.scrollIntoView(),e.replyHTML=n},this.sortComments=t=>{let e=[];this.allCommentsObj.forEach((t=>{e.push(t)})),document.querySelectorAll(".tred").forEach((t=>{t.remove()})),"По дате"==t?e.sort(function(t){return(e,n)=>e[t]>n[t]?1:-1}("fullDate")):"По количеству оценок"==t?e.sort(function(t){return(e,n)=>e[t]<n[t]?1:-1}("absRank")):"По актуальности"==t?e.sort(function(t){return(e,n)=>e[t]<n[t]?1:-1}("fullDate")):"По количеству ответов"==t&&e.sort(function(t){return(e,n)=>e[t]<n[t]?1:-1}("isReplied")),e.forEach((t=>{this.showComments(t)}))},this.loadComments=()=>{if(0!=localStorage.length){for(let t=0;t<localStorage.length;t++){let e=JSON.parse(`${localStorage.getItem(String(t))}`);null!=e&&this.allCommentsObj.set(t,e)}for(let t=.1;t<localStorage.length;t++){let e=JSON.parse(`${localStorage.getItem(String(t))}`);null!=e&&(this.allCommentsObj.get(e.id-.1).replyObj=e,this.allCommentsObj.set(t,e))}this.allCommentsObj.forEach((t=>{this.showComments(t)}))}},this.saveComments=(t,e)=>{localStorage.setItem(String(t),JSON.stringify(e))},this.saveChange=(t,e)=>{localStorage.removeItem(String(t)),localStorage.setItem(String(t),JSON.stringify(e))},this.commentArea=document.querySelector(".comments"),this.inputModule=new i.default,this.allComments=Array.from(document.querySelectorAll(".comment")),this.allCommentsObj=new Map,this.favoriteCommentsObj=new Set,this.quantityOfComments=this.allComments.length,document.querySelector(".info__quantity").innerText=this.quantityOfComments,this.buttonShowFavorite=document.querySelector(".comments__header__favourites"),this.buttonSort=document.querySelector(".sort__button")}makeFavorite(t){if("actions__button__favorite"!==t.classList[0])return;let e=t.parentNode.parentNode.parentNode,n=+e.id,s=this.allCommentsObj.get(n);t.classList.toggle("actions__button__favorite_pressed"),0==s.isFavorite?(s.isFavorite=!0,this.favoriteCommentsObj.add(s),t.textContent="В избранном",e.setAttribute("favorite","true")):1==s.isFavorite&&(s.isFavorite=!1,this.favoriteCommentsObj.delete(s),t.textContent="В избранное",e.setAttribute("favorite","false")),this.saveChange(n,s)}createReply(t){let e=new l.default,n=Number(t.id.split("-")[0]),s=this.allCommentsObj.get(n);e.id=s.id+.1,this.allCommentsObj.set(e.id,e),s.replyObj=e,s.isReplied=!0,this.showReply(s,e),this.saveComments(e.id,e),this.saveChange(n,s)}};document.execCommand("insertBrOnReturn"),new MutationObserver((t=>{t[0].addedNodes[0]&&("tred"!=t[0].addedNodes[0].className&&"reply__answer comment"!=t[0].addedNodes[0].className||r.updateElements())})).observe(r.commentArea,{childList:!0,subtree:!0}),document.addEventListener("click",(t=>{t.target.classList.contains("rating__button")&&r.changeRank(t.target)})),r.buttonShowFavorite.addEventListener("click",r.showFavorite),r.buttonSort.addEventListener("click",(()=>{let t=document.querySelector(".sort__list"),e=Array.from(document.querySelectorAll(".sort-list__item"));t.classList.toggle("invisible"),e.forEach((e=>{e.addEventListener("click",(()=>{r.buttonSort.textContent=e.textContent,t.classList.add("invisible"),r.sortComments(e.textContent)}))}))})),r.inputModule.buttonSend.addEventListener("click",(()=>{r.createComment(),r.inputModule.cleanTextArea(),r.showComments(r.allCommentsObj.get(r.quantityOfComments)),r.updateElements()})),document.addEventListener("click",(t=>{r.makeFavorite(t.target)})),document.addEventListener("click",(t=>{var e,n;if(null==t.target||!t.target.classList.contains("actions__button__reply"))return;let s=Number(t.target.id.split("-")[0]),i=r.allCommentsObj.get(s),a=null===(e=i.appropriateHTMLObject.nextSibling)||void 0===e?void 0:e.nextSibling;if(1==i.isReplied)return;if(document.querySelector(".reply__typing"))return void(null===(n=document.querySelector(".reply__typing"))||void 0===n||n.remove());let l=new o.default;a.innerHTML=l.replyTyping,a.scrollIntoView();let c=document.querySelector(".reply__typing"),m=document.querySelector(".reply-textarea"),d=document.querySelector(".reply-placeholder"),u=m.textContent,_=document.querySelector(".reply-button");function h(){(0==u.length||u.length>l.maxLength)&&l.makeButtonDisabled(_)}_.setAttribute("id",`${i.id}-reply-btn`),m.onfocus=()=>{d.style.display="none"},m.onblur=()=>{0==u.length&&(l.makeButtonDisabled(_),d.style.display="inline",document.querySelector(".reply-symbols_empty").classList.remove("invisible"),document.querySelector(".reply-symbols_typing").classList.add("invisible")),u.length>l.maxLength&&l.makeButtonDisabled(_)},m.addEventListener("input",(t=>{document.querySelector(".reply-symbols_empty").classList.add("invisible"),document.querySelector(".reply-symbols_typing").classList.remove("invisible"),u.length+1>l.maxLength&&"insertText"==t.inputType&&(m.textContent=u.substring(0,l.maxLength),m.focus(),l.placeCaretAtEnd(document.querySelector(".reply-textarea"))),u=m.textContent,document.querySelector(".reply-symbols__quantity").innerHTML=u.length,u.length>0&&u.length<l.maxLength&&l.makeButtonEnabled(_)})),m.addEventListener("paste",(t=>{const e=t.clipboardData||window.clipboardData;e&&e.types&&e.types.includes("Files")&&t.preventDefault()})),m.addEventListener("paste",(t=>{t.preventDefault();let e=t.clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,e)})),m.addEventListener("keydown",(()=>{setTimeout(h,1)})),_.addEventListener("click",(()=>{r.createReply(_),c.remove()}))})),r.loadComments()},526:function(t,e){Object.defineProperty(e,"__esModule",{value:!0});class n{constructor(){this.cleanTextArea=()=>{this.input.innerText="",this.content="",this.placeholder.style.display="inline",document.querySelector(".main__symbols_empty").classList.remove("invisible"),document.querySelector(".main__symbols_typing").classList.add("invisible"),this.makeButtonDisabled()},this.name="Аноним",this.maxLength=1e3,this.input=document.querySelector(".textarea__input"),this.content=this.input.textContent,this.placeholder=document.querySelector(".textarea__placeholder"),this.buttonSend=document.querySelector(".typing__button"),this.input}placeCaretAtEnd(t){if(t.focus(),void 0!==window.getSelection&&void 0!==document.createRange){let e=document.createRange();e.selectNodeContents(t),e.collapse(!1);let n=window.getSelection();n.removeAllRanges(),n.addRange(e)}else if(void 0!==document.body.createRange){let e=document.body.createRange();e.moveToElementText(t),e.collapse(!1),e.select()}}makeButtonEnabled(){this.buttonSend.classList.remove("button_disabled"),this.buttonSend.classList.add("button_enabled"),this.buttonSend.disabled=!1}makeButtonDisabled(){this.buttonSend.classList.add("button_disabled"),this.buttonSend.classList.remove("button_enabled"),this.buttonSend.disabled=!0}}let s=new n;function i(){0==s.content.length&&s.makeButtonDisabled(),s.content.length>s.maxLength&&s.makeButtonDisabled()}s.input.onfocus=()=>{s.placeholder.style.display="none"},s.input.onblur=()=>{0==s.content.length&&(s.makeButtonDisabled(),s.placeholder.style.display="inline",document.querySelector(".main__symbols_empty").classList.remove("invisible"),document.querySelector(".main__symbols_typing").classList.add("invisible")),s.content.length>s.maxLength&&s.makeButtonDisabled()},s.input.addEventListener("input",(t=>{document.querySelector(".main__symbols_empty").classList.add("invisible"),document.querySelector(".main__symbols_typing").classList.remove("invisible"),s.content.length+1>s.maxLength&&"insertText"==t.inputType&&(s.input.textContent=s.content.substring(0,s.maxLength),s.input.focus(),s.placeCaretAtEnd(document.querySelector(".textarea__input"))),s.content=s.input.textContent,document.querySelector(".symbols__quantity").innerHTML=s.content.length,s.content.length>0&&s.content.length<s.maxLength&&s.makeButtonEnabled()})),s.input.addEventListener("paste",(t=>{const e=t.clipboardData||window.clipboardData;e&&e.types&&e.types.includes("Files")&&t.preventDefault()})),s.input.addEventListener("paste",(t=>{t.preventDefault();let e=t.clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,e)})),s.input.addEventListener("keydown",(()=>{setTimeout(i,1)})),e.default=n},620:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this.name=document.querySelector(".main__name").textContent,this.rank=0,this.absRank=Math.abs(this.rank),this.rankStatus="none",this.freePoints=1,this.isFavorite=!1,this.month=(new Date).getMonth()+1,this.month<10&&(this.month="0"+this.month),this.day=(new Date).getDate(),this.day<10&&(this.day="0"+this.day),this.hours=(new Date).getHours(),this.hours<10&&(this.hours="0"+this.hours),this.minutes=(new Date).getMinutes(),this.minutes<10&&(this.minutes="0"+this.minutes),this.date=`${this.day}.${this.month} ${this.hours}:${this.minutes}`,this.replyText=document.querySelector(".reply-textarea").textContent}}},527:function(t,e){Object.defineProperty(e,"__esModule",{value:!0});class n{constructor(){this.cleanTextArea=()=>{this.inputReply.innerText="",this.contentReply="",this.placeholderReply.style.display="inline",document.querySelector(".main__symbols_empty").classList.remove("invisible"),document.querySelector(".main__symbols_typing").classList.add("invisible")},this.name="Аноним",document.querySelector(".main__name").textContent=this.name,this.maxLength=1e3,this.replyTyping=`\n    <div class="reply__typing">\n                <div class="reply-typing__avatar avatar">\n                  <img class="avatar__image" src="https://loremflickr.com/61/61" alt="avatar" />\n                </div>\n                <div class="reply-typing__main">\n                  <div class="main__name-and-symbols">\n                    <p class="main__name">${this.name}</p>\n                    <p class="main__symbols main__symbols_empty reply-symbols_empty">Макс. 1000 символов</p>\n                    <p class="main__symbols main__symbols_typing reply-symbols_typing invisible">\n                      <span class="symbols__quantity reply-symbols__quantity">1</span>/1000\n                    </p>\n                  </div>\n                  <div class="main__textarea">\n                    <span class="textarea__placeholder reply-placeholder">Введите текст сообщения...</span>\n                    <div class="textarea__input reply-textarea" contenteditable="true" ondrop="return false;"></div>\n                  </div>\n                </div>\n                <button class="typing__button reply-button button_disabled" disabled>Ответить</button>\n              </div>`}placeCaretAtEnd(t){if(t.focus(),void 0!==window.getSelection&&void 0!==document.createRange){let e=document.createRange();e.selectNodeContents(t),e.collapse(!1);let n=window.getSelection();n.removeAllRanges(),n.addRange(e)}else if(void 0!==document.body.createRange){let e=document.body.createRange();e.moveToElementText(t),e.collapse(!1),e.select()}}makeButtonEnabled(t){t.classList.remove("button_disabled"),t.classList.add("button_enabled"),t.disabled=!1}makeButtonDisabled(t){t.classList.add("button_disabled"),t.classList.remove("button_enabled"),t.disabled=!0}}new n,e.default=n}},e={};!function n(s){var i=e[s];if(void 0!==i)return i.exports;var a=e[s]={exports:{}};return t[s].call(a.exports,a,a.exports,n),a.exports}(497)}();